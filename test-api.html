<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Connection Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        .status {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
        }
        .status.success { background: #10b981; }
        .status.error { background: #ef4444; }
        .status.loading { background: #fbbf24; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        button {
            background: #0891b2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0ea5e9; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>üîó API Connection Test</h1>
    
    <div class="test-section">
        <h2>‚úÖ Server Status</h2>
        <p><span class="status success"></span>Frontend: http://localhost:8000</p>
        <p><span class="status success"></span>Backend: http://localhost:8081</p>
    </div>

    <div class="test-section">
        <h2>üß™ Test API Connection</h2>
        <button onclick="testBackendConnection()">Test Java Backend</button>
        <button onclick="testBookingAPI()">Test Booking API</button>
        <button onclick="testH2Console()">Test H2 Database</button>
        <div id="results"></div>
    </div>

    <div class="test-section">
        <h2>üåê React App Links</h2>
        <p><a href="http://localhost:8000" style="color: #0891b2;">üè† Home Page</a></p>
        <p><a href="http://localhost:8000/admin" style="color: #0891b2;">üîß Admin Page</a></p>
        <p><a href="http://localhost:8000/about" style="color: #0891b2;">üë§ About Page</a></p>
        <p><a href="http://localhost:8000/contact" style="color: #0891b2;">üìû Contact Page</a></p>
    </div>

    <script>
        function addResult(message, isSuccess = true) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.innerHTML = `<span class="status ${isSuccess ? 'success' : 'error'}"></span>${message}`;
            div.style.margin = '10px 0';
            results.appendChild(div);
        }

        async function testBackendConnection() {
            addResult('Testing Java backend connection...', null);
            try {
                const response = await fetch('http://localhost:8081/api/bookings');
                if (response.ok) {
                    const data = await response.json();
                    addResult(`‚úÖ Backend connected! Found ${data.length} bookings`);
                } else {
                    addResult(`‚ùå Backend error: ${response.status}`);
                }
            } catch (error) {
                addResult(`‚ùå Connection failed: ${error.message}`);
            }
        }

        async function testBookingAPI() {
            addResult('Testing booking creation...', null);
            try {
                const bookingData = {
                    customerName: "Test User",
                    customerEmail: "test@example.com",
                    customerPhone: "1234567890",
                    packageId: 1,
                    selectedDate: "2025-09-04",
                    selectedTime: "10:00 AM",
                    specialRequests: "Test booking"
                };

                const response = await fetch('http://localhost:8081/api/bookings/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bookingData)
                });

                if (response.ok) {
                    const result = await response.json();
                    addResult(`‚úÖ Booking created! ID: ${result.data?.bookingId || 'N/A'}`);
                } else {
                    addResult(`‚ùå Booking failed: ${response.status}`);
                }
            } catch (error) {
                addResult(`‚ùå Booking error: ${error.message}`);
            }
        }

        async function testH2Console() {
            addResult('Testing H2 database console...', null);
            try {
                const response = await fetch('http://localhost:8081/h2-console');
                if (response.ok) {
                    addResult('‚úÖ H2 Console accessible');
                } else {
                    addResult(`‚ùå H2 Console error: ${response.status}`);
                }
            } catch (error) {
                addResult(`‚ùå H2 Console error: ${error.message}`);
            }
        }

        // Auto-test on page load
        window.onload = function() {
            setTimeout(testBackendConnection, 1000);
        };
    </script>
</body>
</html>
